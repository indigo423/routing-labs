name: lab-01

mgmt:
  network: fixedips
  ipv4-subnet: 203.0.113.0/24
  ipv6-subnet: 2001:db8::/64

topology:
  nodes:
    router1:
      kind: linux
      mgmt-ipv4: 203.0.113.32
      mgmt-ipv6: 2001:db8::32
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router1/daemons:/etc/frr/daemons
        - router1/frr.conf:/etc/frr/frr.conf
        - router1/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router2:
      kind: linux
      mgmt-ipv4: 203.0.113.33
      mgmt-ipv6: 2001:db8::33
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router2/daemons:/etc/frr/daemons
        - router2/frr.conf:/etc/frr/frr.conf
        - router2/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router3:
      kind: linux
      mgmt-ipv4: 203.0.113.34
      mgmt-ipv6: 2001:db8::34
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router3/daemons:/etc/frr/daemons
        - router3/frr.conf:/etc/frr/frr.conf
        - router3/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router4:
      kind: linux
      mgmt-ipv4: 203.0.113.35
      mgmt-ipv6: 2001:db8::35
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router4/daemons:/etc/frr/daemons
        - router4/frr.conf:/etc/frr/frr.conf
        - router4/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router5:
      kind: linux
      mgmt-ipv4: 203.0.113.36
      mgmt-ipv6: 2001:db8::36
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router5/daemons:/etc/frr/daemons
        - router5/frr.conf:/etc/frr/frr.conf
        - router5/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router6:
      kind: linux
      mgmt-ipv4: 203.0.113.37
      mgmt-ipv6: 2001:db8::37
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router6/daemons:/etc/frr/daemons
        - router6/frr.conf:/etc/frr/frr.conf
        - router6/pmacctd.conf:/etc/pmacct/pmacctd.conf
    router7:
      kind: linux
      mgmt-ipv4: 203.0.113.38
      mgmt-ipv6: 2001:db8::38
      image: quay.io/labmonkeys/frrouting:10.2.1.b3521
      binds:
        - router7/daemons:/etc/frr/daemons
        - router7/frr.conf:/etc/frr/frr.conf
        - router7/pmacctd.conf:/etc/pmacct/pmacctd.conf
    pc1:
      kind: linux
      mgmt-ipv4: 203.0.113.128
      mgmt-ipv6: 2001:db8::128
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.9/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.1 dev eth1
    pc2:
      kind: linux
      mgmt-ipv4: 203.0.113.129
      mgmt-ipv6: 2001:db8::129
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.25/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.17 dev eth1
    pc3:
      kind: linux
      mgmt-ipv4: 203.0.113.130
      mgmt-ipv6: 2001:db8::130
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.41/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.33 dev eth1
    pc4:
      kind: linux
      mgmt-ipv4: 203.0.113.131
      mgmt-ipv6: 2001:db8::131
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.57/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.49 dev eth1
    pc5:
      kind: linux
      mgmt-ipv4: 203.0.113.132
      mgmt-ipv6: 2001:db8::132
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.73/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.65 dev eth1
    pc6:
      kind: linux
      mgmt-ipv4: 203.0.113.133
      mgmt-ipv6: 2001:db8::133
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.89/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.81 dev eth1
    pc7:
      kind: linux
      mgmt-ipv4: 203.0.113.134
      mgmt-ipv6: 2001:db8::134
      image: ghcr.io/srl-labs/network-multitool
      exec:
        - ip address add 198.51.100.105/28 dev eth1
        - ip route add 198.51.100.0/24 via 198.51.100.97 dev eth1
    minion:
      kind: linux
      mgmt-ipv4: 203.0.113.64
      mgmt-ipv6: 2001:db8::64
      image: opennms/minion:33.1.2
      binds:
        - ./minion/container-fs/minion-etc-overlay:/opt/minion-etc-overlay
  links:
    - endpoints: ["router1:eth1", "router2:eth1"]
    - endpoints: ["router1:eth2", "router3:eth1"]
    - endpoints: ["router2:eth2", "router3:eth2"]
    - endpoints: ["router3:eth4", "router4:eth4"]
    - endpoints: ["router4:eth1", "router5:eth1"]
    - endpoints: ["router4:eth2", "router6:eth1"]
    - endpoints: ["router5:eth2", "router6:eth2"]
    - endpoints: ["router6:eth4", "router7:eth1"]
    - endpoints: ["pc1:eth1", "router1:eth3"]
    - endpoints: ["pc2:eth1", "router2:eth3"]
    - endpoints: ["pc3:eth1", "router3:eth3"]
    - endpoints: ["pc4:eth1", "router4:eth3"]
    - endpoints: ["pc5:eth1", "router5:eth3"]
    - endpoints: ["pc6:eth1", "router6:eth3"]
    - endpoints: ["pc7:eth1", "router7:eth2"]
